---
feature: pre-tool-guide
created: 2026-02-07
status: draft
---

# êµ¬í˜„ ê³„íš: pre-tool-guide

> `hooks/pre-tool-guide.mjs` â€” PreToolUse ì‚¬ì „ ì˜ˆë°© ê°€ì´ë“œ í›… êµ¬í˜„ ê³„íš

---

## ê°œìš”

pre-tool-guideëŠ” ë„êµ¬ ì‹¤í–‰ ì „ì— ê³¼ê±° í•™ìŠµ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‚¬ì „ ê²½ê³ ë¥¼ ì£¼ìž…í•˜ëŠ” PreToolUse í›…ì´ë‹¤. Edit/Write(íŒŒì¼ ì—ëŸ¬ ì´ë ¥), Bash(ì„¸ì…˜ ë‚´ ì—ëŸ¬), Task(ì„œë¸Œì—ì´ì „íŠ¸ ì‹¤íŒ¨ìœ¨) 3ê°€ì§€ ë„êµ¬ë³„ ê°€ì´ë“œë¥¼ ì œê³µí•œë‹¤.

---

## ê¸°ìˆ  ê²°ì •

### ê²°ì • 1: ë„êµ¬ë³„ ë¶„ê¸° ì²˜ë¦¬ êµ¬ì¡°

**ê·¼ê±°:** ê° ë„êµ¬ì— í•„ìš”í•œ ê°€ì´ë“œ ë°ì´í„°ì™€ ì†ŒìŠ¤ê°€ ë‹¤ë¥´ë¯€ë¡œ, `tool_name` ê¸°ë°˜ if-else ë¶„ê¸°ê°€ ê°€ìž¥ ëª…í™•í•˜ë‹¤.

**ëŒ€ì•ˆ ê²€í† :**
- Strategy íŒ¨í„´: 3ê°€ì§€ ë¶„ê¸°ì— ê³¼ë„í•œ ì¶”ìƒí™”
- Map ê¸°ë°˜ í•¸ë“¤ëŸ¬: ê°€ë…ì„±ì€ ì¢‹ìœ¼ë‚˜ ê° í•¸ë“¤ëŸ¬ì˜ ìž…ë ¥ì´ ë‹¬ë¼ ì‹¤ìµ ì—†ìŒ

### ê²°ì • 2: readEntries() ìµœëŒ€ ê±´ìˆ˜ ì œí•œ

**ê·¼ê±°:** ëŒ€ìš©ëŸ‰ ë¡œê·¸ íŒŒì¼ì—ì„œ ì „ì²´ë¥¼ ì½ìœ¼ë©´ 2s íƒ€ìž„ì•„ì›ƒ ìœ„í—˜. Edit/WriteëŠ” 200ê±´, BashëŠ” 100ê±´ìœ¼ë¡œ ì œí•œ.

---

## êµ¬í˜„ ë‹¨ê³„

### Phase 1: ìŠ¤ìºí´ë“œ ë° ë„êµ¬ í•„í„°ë§

í›… ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ìƒì„±, ëŒ€ìƒ ë„êµ¬ ë¶„ê¸° êµ¬ì¡°

**ì‚°ì¶œë¬¼:**
- [ ] `hooks/pre-tool-guide.mjs` íŒŒì¼ ìƒì„± (import, try-catch, ë„êµ¬ ë¶„ê¸°)
- [ ] ëŒ€ìƒ ì™¸ ë„êµ¬ ì¦‰ì‹œ ì¢…ë£Œ ë¡œì§
- [ ] stdin ì½ê¸° + tool_name ë¶„ê¸° í…ŒìŠ¤íŠ¸

### Phase 2: ë„êµ¬ë³„ ê°€ì´ë“œ ë¡œì§

Edit/Write, Bash, Task ê°ê°ì˜ ê°€ì´ë“œ ë¡œì§ êµ¬í˜„

**ì‚°ì¶œë¬¼:**
- [ ] Edit/Write ê°€ì´ë“œ: file_path â†’ prompt-log ì—ëŸ¬ ê²€ìƒ‰ â†’ error-kb ì¡°íšŒ â†’ ì¶œë ¥
- [ ] Bash ê°€ì´ë“œ: session_id ê¸°ë°˜ ì—ëŸ¬ ê²€ìƒ‰ â†’ error-kb ì¡°íšŒ â†’ toolSequence í‘œì‹œ
- [ ] Task ê°€ì´ë“œ: subagent-stats.jsonl â†’ ì‹¤íŒ¨ìœ¨ ê³„ì‚° â†’ 30% ì´ˆê³¼ ì‹œ ê²½ê³ 
- [ ] ê° ê°€ì´ë“œë³„ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

### Phase 3: í†µí•© ë° ì¶œë ¥ í…ŒìŠ¤íŠ¸

ì „ì²´ íŒŒì´í”„ë¼ì¸ í†µí•© ë° stdout JSON ì¶œë ¥ ê²€ì¦

**ì‚°ì¶œë¬¼:**
- [ ] ë³µí•© ê°€ì´ë“œ ì¶œë ¥ í…ŒìŠ¤íŠ¸ (Edit + Bash ê°€ì´ë“œ ë™ì‹œ í•´ë‹¹ ì‹œ)
- [ ] hookSpecificOutput JSON í¬ë§· ê²€ì¦
- [ ] exit 0 ë³´ìž¥ í…ŒìŠ¤íŠ¸
- [ ] 2s íƒ€ìž„ì•„ì›ƒ ë‚´ ì™„ë£Œ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸

---

## ë¦¬ìŠ¤í¬ ë¶„ì„

| ë¦¬ìŠ¤í¬ | ì˜í–¥ë„ | ì™„í™” ì „ëžµ |
|--------|--------|----------|
| PreToolUse í›…ì´ ë§¤ ë„êµ¬ í˜¸ì¶œë§ˆë‹¤ ì‹¤í–‰ë˜ì–´ ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ | ðŸŸ¡ MEDIUM | ëŒ€ìƒ ì™¸ ë„êµ¬ ì¦‰ì‹œ ì¢…ë£Œ, readEntries ê±´ìˆ˜ ì œí•œ |
| error-kb ëª¨ë“ˆ ì˜ì¡´ì„±ìœ¼ë¡œ ëª¨ë“ˆ ë¡œë“œ ì‹œê°„ ì¦ê°€ | ðŸŸ¢ LOW | ê²½ëŸ‰ ëª¨ë“ˆ, import ë¹„ìš© ë¯¸ë¯¸ |
| subagent-stats.jsonlì´ ì•„ì§ ì—†ëŠ” ì´ˆê¸° ìƒíƒœ | ðŸŸ¢ LOW | existsSync ì²´í¬ í›„ ìŠ¤í‚µ |

---

## í…ŒìŠ¤íŠ¸ ì „ëžµ

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

- ë„êµ¬ í•„í„°ë§: Edit, Write, Bash, Task ì™¸ ë„êµ¬ ìŠ¤í‚µ
- Edit/Write ê°€ì´ë“œ: íŒŒì¼ ì—ëŸ¬ ìžˆìŒ/ì—†ìŒ, KB ë§¤ì¹˜ ìžˆìŒ/ì—†ìŒ
- Bash ê°€ì´ë“œ: ì„¸ì…˜ ë‚´ ì—ëŸ¬ ìžˆìŒ/ì—†ìŒ, toolSequence í‘œì‹œ
- Task ê°€ì´ë“œ: ì‹¤íŒ¨ìœ¨ >30%, <=30%, ë°ì´í„° ë¶€ì¡±(<5ê±´)

### í†µí•© í…ŒìŠ¤íŠ¸

- error-kb ëª¨ë“ˆ + log-writer ëª¨ë“ˆ ì—°ë™ ì „ì²´ íŒŒì´í”„ë¼ì¸

---

## ë‹¤ìŒ ë‹¨ê³„

1. [ ] ì´ ê³„íšì— ëŒ€í•œ ê²€í†  ë° ìŠ¹ì¸
2. [ ] error-kb, subagent-tracker êµ¬í˜„ ì™„ë£Œ í›„ ì°©ìˆ˜ (ì˜ì¡´ì„±)
3. [ ] Phase 1ë¶€í„° ìˆœì°¨ êµ¬í˜„ ì‹œìž‘
